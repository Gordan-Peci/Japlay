const jlptN5Questions = [
    {
        question: "What does 'こんにちは' mean?",
        answers: ["Hello", "Goodbye", "Thank you", "Excuse me"],
        correctIndex: 0
    },
    {
        question: "How do you say 'book' in Japanese?",
        answers: ["ほん (hon)", "かみ (kami)", "つくえ (tsukue)", "いす (isu)"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'water'?",
        answers: ["みず (mizu)", "ひ (hi)", "そら (sora)", "かぜ (kaze)"],
        correctIndex: 0
    },
    {
        question: "Which particle indicates the subject of a sentence?",
        answers: ["は (wa)", "を (wo)", "に (ni)", "で (de)"],
        correctIndex: 0
    },
    {
        question: "What does 'たべます' mean?",
        answers: ["To eat", "To drink", "To see", "To go"],
        correctIndex: 0
    },
    {
        question: "How do you say 'I' in Japanese (formal)?",
        answers: ["わたし (watashi)", "ぼく (boku)", "おれ (ore)", "わたくし (watakushi)"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 人?",
        answers: ["ひと (hito)", "にん (nin)", "じん (jin)", "にんげん (ningen)"],
        correctIndex: 0
    },
    {
        question: "What does 'ありがとう' mean?",
        answers: ["Thank you", "I'm sorry", "Good morning", "Good night"],
        correctIndex: 0
    },
    {
        question: "Which number is '七'?",
        answers: ["7", "1", "4", "9"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'big'?",
        answers: ["おおきい (ookii)", "ちいさい (chiisai)", "たかい (takai)", "やすい (yasui)"],
        correctIndex: 0
    },
    {
        question: "What does 'いきます' mean?",
        answers: ["To go", "To come", "To return", "To stay"],
        correctIndex: 0
    },
    {
        question: "How do you say 'teacher' in Japanese?",
        answers: ["せんせい (sensei)", "がくせい (gakusei)", "いしゃ (isha)", "えんぴつ (enpitsu)"],
        correctIndex: 0
    },
    {
        question: "Which is the correct way to say 'I am a student'?",
        answers: ["わたしはがくせいです", "わたしがくせいです", "がくせいですわたし", "がくせいわたしです"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'cat'?",
        answers: ["ねこ (neko)", "いぬ (inu)", "とり (tori)", "さかな (sakana)"],
        correctIndex: 0
    },
    {
        question: "What does 'すみません' mean?",
        answers: ["Excuse me / I'm sorry", "Thank you", "Goodbye", "Hello"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'dog'?",
        answers: ["いぬ (inu)", "ねこ (neko)", "うま (uma)", "さかな (sakana)"],
        correctIndex: 0
    },
    {
        question: "How do you say 'good morning' in Japanese?",
        answers: ["おはようございます", "こんにちは", "こんばんは", "おやすみなさい"],
        correctIndex: 0
    },
    {
        question: "Which number is '三'?",
        answers: ["3", "2", "5", "8"],
        correctIndex: 0
    },
    {
        question: "What does 'のみます' mean?",
        answers: ["To drink", "To eat", "To see", "To read"],
        correctIndex: 0
    },
    {
        question: "Which particle is used to indicate a direct object?",
        answers: ["を (o)", "は (wa)", "が (ga)", "へ (e)"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 山?",
        answers: ["やま (yama)", "かわ (kawa)", "たに (tani)", "はな (hana)"],
        correctIndex: 0
    },
    {
        question: "How do you say 'it's expensive' in Japanese?",
        answers: ["たかいです", "やすいです", "おおきいです", "ちいさいです"],
        correctIndex: 0
    },
    {
        question: "What does 'だいがく' mean?",
        answers: ["University", "High school", "Student", "Teacher"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'mother' (polite)?",
        answers: ["おかあさん", "おとうさん", "おねえさん", "おとうと"],
        correctIndex: 0
    },
    {
        question: "How do you say 'I like apples'?",
        answers: ["りんごがすきです", "りんごをたべます", "りんごがきらいです", "りんごのみます"],
        correctIndex: 0
    },
     {
        question: "What does 'きょう' mean?",
        answers: ["Today", "Tomorrow", "Yesterday", "Now"],
        correctIndex: 0
    },
    {
        question: "How do you say 'to see/look' in Japanese?",
        answers: ["みます", "ききます", "よみます", "かきます"],
        correctIndex: 0
    },
    {
        question: "Which particle indicates a destination or direction?",
        answers: ["へ (e)", "を (o)", "で (de)", "と (to)"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'small'?",
        answers: ["ちいさい", "おおきい", "あたらしい", "ふるい"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 月?",
        answers: ["つき", "ほし", "そら", "てん"],
        correctIndex: 0
    },
    {
        question: "How do you say 'I do not understand'?",
        answers: ["わかりません", "しりません", "できません", "いいえ"],
        correctIndex: 0
    },
    {
        question: "What does 'ばんごはん' mean?",
        answers: ["Dinner", "Breakfast", "Lunch", "Food"],
        correctIndex: 0
    },
    {
        question: "Which is the correct counter for flat objects (like paper)?",
        answers: ["まい", "こ", "さつ", "ほん"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'car'?",
        answers: ["くるま", "でんしゃ", "じてんしゃ", "ひこうき"],
        correctIndex: 0
    },
    {
        question: "How do you say 'Please give me water'?",
        answers: ["みずをください", "みずがあります", "みずがいます", "みずをのみます"],
        correctIndex: 0
    },
        {
        question: "What does 'あした' mean?",
        answers: ["Tomorrow", "Today", "Yesterday", "Now"],
        correctIndex: 0
    },
    {
        question: "How do you say 'to write' in Japanese?",
        answers: ["かきます", "よみます", "ききます", "みます"],
        correctIndex: 0
    },
    {
        question: "Which particle means 'and' when connecting nouns?",
        answers: ["と", "や", "も", "に"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'new'?",
        answers: ["あたらしい", "ふるい", "ちいさい", "おおきい"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 日?",
        answers: ["にち", "ひ", "び", "すべて"],
        correctIndex: 0
    },
    {
        question: "How do you say 'I don't know'?",
        answers: ["しりません", "わかりません", "できません", "いいえ"],
        correctIndex: 0
    },
    {
        question: "What does 'あさごはん' mean?",
        answers: ["Breakfast", "Lunch", "Dinner", "Snack"],
        correctIndex: 0
    },
    {
        question: "Which is the correct counter for books?",
        answers: ["さつ", "まい", "ほん", "こ"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'train'?",
        answers: ["でんしゃ", "くるま", "ひこうき", "バス"],
        correctIndex: 0
    },
    {
        question: "How do you say 'Please speak slowly'?",
        answers: ["ゆっくりはなしてください", "もういちどいってください", "はなしてください", "きいてください"],
        correctIndex: 0
    },
        {
        question: "What does 'きのう' mean?",
        answers: ["Yesterday", "Today", "Tomorrow", "Now"],
        correctIndex: 0
    },
    {
        question: "How do you say 'to read' in Japanese?",
        answers: ["よみます", "かきます", "ききます", "みます"],
        correctIndex: 0
    },
    {
        question: "Which particle indicates a location where an action takes place?",
        answers: ["で", "に", "へ", "を"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'old' (not age)?",
        answers: ["ふるい", "あたらしい", "おおきい", "ちいさい"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 木?",
        answers: ["き", "もく", "ぼく", "こ"],
        correctIndex: 0
    },
    {
        question: "How do you say 'I can't do it'?",
        answers: ["できません", "しりません", "わかりません", "いいえ"],
        correctIndex: 0
    },
    {
        question: "What does 'ひるごはん' mean?",
        answers: ["Lunch", "Breakfast", "Dinner", "Meal"],
        correctIndex: 0
    },
    {
        question: "Which is the correct counter for long, cylindrical objects?",
        answers: ["ほん", "まい", "さつ", "こ"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'bicycle'?",
        answers: ["じてんしゃ", "くるま", "でんしゃ", "バス"],
        correctIndex: 0
    },
    {
        question: "How do you say 'Please say that again'?",
        answers: ["もういちどいってください", "ゆっくりはなしてください", "しずかにはなしてください", "おおきなこえではなしてください"],
        correctIndex: 0
    },
        {
        question: "What is the meaning of 'ともだち'?",
        answers: ["Friend", "Teacher", "Student", "Family"],
        correctIndex: 0
    },
    {
        question: "How do you say 'to listen/hear' in Japanese?",
        answers: ["ききます", "みます", "よみます", "たべます"],
        correctIndex: 0
    },
    {
        question: "Which particle indicates a specific point in time?",
        answers: ["に", "で", "へ", "を"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'hot' (weather)?",
        answers: ["あつい", "さむい", "あたたかい", "すずしい"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 川?",
        answers: ["かわ", "やま", "うみ", "いけ"],
        correctIndex: 0
    },
    {
        question: "How do you say 'I don't have'?",
        answers: ["ありません", "じゃありません", "できません", "しりません"],
        correctIndex: 0
    },
    {
        question: "What does 'しごと' mean?",
        answers: ["Job/Work", "School", "Home", "Game"],
        correctIndex: 0
    },
    {
        question: "Which is the correct counter for small objects?",
        answers: ["こ", "ほん", "まい", "さつ"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'money'?",
        answers: ["おかね", "ほん", "かみ", "とけい"],
        correctIndex: 0
    },
    {
        question: "How do you ask 'What is this?' politely?",
        answers: ["これはなんですか", "これはだれですか", "これはいくらですか", "これはどこですか"],
        correctIndex: 0
    },
        {
        question: "What does 'げんき' mean?",
        answers: ["Healthy/energetic", "Tired", "Quiet", "Busy"],
        correctIndex: 0
    },
    {
        question: "How do you say 'to buy' in Japanese?",
        answers: ["かいます", "うります", "もちます", "とります"],
        correctIndex: 0
    },
    {
        question: "Which particle indicates the location of existence for inanimate objects?",
        answers: ["に", "で", "を", "へ"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'cold' (weather)?",
        answers: ["さむい", "あつい", "くらしい", "すずしい"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 田?",
        answers: ["た", "でん", "だ", "はたけ"],
        correctIndex: 0
    },
    {
        question: "How do you say 'There is a book'?",
        answers: ["ほんがあります", "ほんがいます", "ほんをよみます", "ほんがいます"],
        correctIndex: 0
    },
    {
        question: "What does 'でんわ' mean?",
        answers: ["Telephone", "Computer", "Television", "Radio"],
        correctIndex: 0
    },
    {
        question: "Which counter is used for people?",
        answers: ["にん", "こ", "ほん", "さつ"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'house'?",
        answers: ["いえ", "うち", "アパート", "まち"],
        correctIndex: 0
    },
    {
        question: "How do you ask 'How much is this?'",
        answers: ["これはいくらですか", "これはなんですか", "これはだれですか", "これはどこですか"],
        correctIndex: 0
    },
        {
        question: "What does 'いま' mean?",
        answers: ["Now", "Later", "Before", "Soon"],
        correctIndex: 0
    },
    {
        question: "How do you say 'to meet' in Japanese?",
        answers: ["あいます", "みます", "いきます", "きます"],
        correctIndex: 0
    },
    {
        question: "Which particle indicates the location of existence for animate objects?",
        answers: ["に", "で", "を", "が"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'interesting/funny'?",
        answers: ["おもしろい", "つまらない", "たのしい", "かなしい"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 口?",
        answers: ["くち", "こう", "ぐち", "まん"],
        correctIndex: 0
    },
    {
        question: "How do you say 'There is a teacher'?",
        answers: ["せんせいがいます", "せんせいがあります", "せんせいです", "せんせいをみます"],
        correctIndex: 0
    },
    {
        question: "What does 'としょかん' mean?",
        answers: ["Library", "Bookstore", "School", "Office"],
        correctIndex: 0
    },
    {
        question: "How do you count flat objects like paper?",
        answers: ["まい", "さつ", "ほん", "こ"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'city'?",
        answers: ["まち", "いえ", "がっこう", "かいしゃ"],
        correctIndex: 0
    },
    {
        question: "How do you say 'I like Japan'?",
        answers: ["にほんがすきです", "にほんへいきます", "にほんをたべます", "にほんにいます"],
        correctIndex: 0
    },
        {
        question: "What does 'やすみます' mean?",
        answers: ["To rest", "To work", "To play", "To study"],
        correctIndex: 0
    },
    {
        question: "How do you say 'blue' in Japanese?",
        answers: ["あおい", "あかい", "くろい", "しろい"],
        correctIndex: 0
    },
    {
        question: "Which particle means 'also'?",
        answers: ["も", "と", "に", "で"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'white'?",
        answers: ["しろい", "くろい", "あかい", "あおい"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 百?",
        answers: ["ひゃく", "びゃく", "もも", "なん"],
        correctIndex: 0
    },
    {
        question: "How do you say 'I understand'?",
        answers: ["わかります", "しります", "できます", "あります"],
        correctIndex: 0
    },
    {
        question: "What does 'びょういん' mean?",
        answers: ["Hospital", "Pharmacy", "School", "Office"],
        correctIndex: 0
    },
    {
        question: "Which counter is used for days?",
        answers: ["にち", "ひ", "か", "び"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'restaurant'?",
        answers: ["レストラン", "スーパー", "デパート", "ホテル"],
        correctIndex: 0
    },
    {
        question: "How do you ask 'Where is the station?'",
        answers: ["えきはどこですか", "えきはなんですか", "えきはだれですか", "えきはいつですか"],
        correctIndex: 0
    },
    {
        question: "What does 'あけます' mean?",
        answers: ["To open", "To close", "To start", "To finish"],
        correctIndex: 0
    },
    {
        question: "How do you say 'red' in Japanese?",
        answers: ["あかい", "あおい", "きいろい", "みどり"],
        correctIndex: 0
    },
    {
        question: "Which particle indicates 'from'?",
        answers: ["から", "まで", "より", "だけ"],
        correctIndex: 0
    },
    {
        question: "What is the Japanese word for 'black'?",
        answers: ["くろい", "しろい", "あかい", "ちゃいろい"],
        correctIndex: 0
    },
    {
        question: "What is the reading of this kanji: 千?",
        answers: ["せん", "ち", "ぜん", "まん"],
        correctIndex: 0
    }

];

let questionCounter = 0;
let untilNextUpgrade = 3;

let usedQuestions = [];
let currentQUestion = null;

const questionText = document.getElementById('questionText');
const answer1 = document.getElementById('answer1');
const answer2 = document.getElementById('answer2');
const answer3 = document.getElementById('answer3');
const answer4 = document.getElementById('answer4');
const answerButtons = [answer1, answer2, answer3, answer4];

answerButtons.forEach((button, index) => {
    button.addEventListener('click', () => {
        checkAnswer(index);
    });
});

function nextQuestion() {
    // Get a random question
    const availableQuestions = jlptN5Questions.filter(q => !usedQuestions.includes(q));
    
    if (availableQuestions.length === 0) {
        console.log("No more questions");
        return;
    }
    
    const randomIndex = Math.floor(Math.random() * availableQuestions.length);
    currentQuestion = availableQuestions[randomIndex];
    usedQuestions.push(currentQuestion);
    
    // Display the question
    displayQuestion(currentQuestion);
}

function displayQuestion(question) {
    questionText.textContent = question.question;
    
    // Shuffle the answers
    const shuffledAnswers = shuffleArray([...question.answers]);
    
    // Display answers on buttons
    answerButtons.forEach((button, index) => {
        button.textContent = shuffledAnswers[index];
    });
    
    // Store correct answer index for shuffled answers
    currentQuestion.shuffledCorrectIndex = shuffledAnswers.indexOf(question.answers[question.correctIndex]);
}

function checkAnswer(selectedIndex) {
    const isCorrect = selectedIndex === currentQuestion.shuffledCorrectIndex;

    showAnswerFeedback(isCorrect);
    
    if (isCorrect) {
        console.log("Correct answer!");
        score += 10;
        questionCounter += 1;
        checkUntilNextUpgrade();
        document.getElementById('score').innerText = `Score: ${score}`;
    } else {
        console.log("Wrong answer");
        // Decrease HP when answer is wrong
        decreaseHP();
        
        // Also decrease time as before
        timeLeft -= 5;
        if (timeLeft < 0) timeLeft = 0;
        document.getElementById('timerDisplay').textContent = `Time: ${timeLeft}s`;
    }
    
    // HIDE THE QUESTION DISPLAY AFTER ANSWERING
    document.getElementById('questionDisplay').style.display = "none";
    
    // Resume the game
    gameState = 'playing';
}

function showAnswerFeedback(isCorrect) {
    const feedback = document.getElementById('answerFeedback');
    const feedbackText = document.getElementById('feedbackText');
    
    if (isCorrect) {
        feedbackText.textContent = "CORRECT!";
        feedback.className = "answer-feedback correct";
    } else {
        feedbackText.textContent = "WRONG!";
        feedback.className = "answer-feedback wrong";
    }
    
    // Show the feedback
    feedback.style.display = "block";
    
    // Hide it after 1.5 seconds
    setTimeout(() => {
        feedback.style.display = "none";
    }, 1000);
}

function checkUntilNextUpgrade(){
    if(questionCounter == untilNextUpgrade){
        console.log("Upgrade radi")
        if (untilNextUpgrade<20){
            untilNextUpgrade +=2;
        }
    }
}

function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}